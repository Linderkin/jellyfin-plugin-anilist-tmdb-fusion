<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>AniFusion Config</title>
    <link rel="stylesheet" href="/web/css/dashboard.css">
</head>
<body>
    <div class="verticalSection">
        <h1>Hola desde AniFusion</h1>
        <div class="formGroup">
            <label for="TmdbApiKey">TMDb API Key:</label>
            <input id="TmdbApiKey" type="text" />
        </div>
        <div class="formGroup">
            <label for="AniListApiKey">AniList API Key:</label>
            <input id="AniListApiKey" type="text" />
        </div>
        <button id="saveConfig" class="raised button-submit block">Guardar</button>
    </div>

    <script>
        document.addEventListener("DOMContentLoaded", () => {
            const pluginId = "8d7a3a6d-1b23-4c77-9b8a-a12d3f4e9e7d";

            async function loadConfig() {
                const response = await ApiClient.getPluginConfiguration(pluginId);
                document.querySelector('#TmdbApiKey').value = response.TmdbApiKey || "";
                document.querySelector('#AniListApiKey').value = response.AniListApiKey || "";
            }

            document.querySelector('#saveConfig').addEventListener('click', async () => {
                const config = await ApiClient.getPluginConfiguration(pluginId);
                config.TmdbApiKey = document.querySelector('#TmdbApiKey').value;
                config.AniListApiKey = document.querySelector('#AniListApiKey').value;
                await ApiClient.updatePluginConfiguration(pluginId, config);
                Dashboard.processPluginConfigurationUpdateResult();
            });

            loadConfig();
        });
    </script>
</body>
</html>